<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Digit Probability Dashboard</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial;
      background: #0f0f0f;
      color: white;
    }
    .box {
      background: #1b1b1b;
      padding: 10px;
      margin: 10px;
      border-radius: 6px;
    }
    select, button {
      background: #222;
      color: white;
      padding: 8px;
      border-radius: 4px;
      border: none;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    function App() {
      const [market, setMarket] = useState("R_10");
      const [ticks, setTicks] = useState([]);
      const chartRef = useRef(null);
      const chartInstance = useRef(null);

      useEffect(() => {
        let ws = new WebSocket("wss://ws.binaryws.com/websockets/v3?app_id=1089");
        ws.onopen = () => ws.send(JSON.stringify({ ticks: market }));
        ws.onmessage = msg => {
          const data = JSON.parse(msg.data);
          if (data.tick) {
            const digit = Number(data.tick.quote.toString().slice(-1));
            setTicks(prev => [...prev.slice(-29), digit]);
          }
        };
        return () => ws.close();
      }, [market]);

      useEffect(() => {
        const counts = Array(10).fill(0);
        ticks.forEach(d => counts[d]++);

        if (chartInstance.current) {
          chartInstance.current.data.datasets[0].data = counts;
          chartInstance.current.update();
        } else {
          chartInstance.current = new Chart(chartRef.current, {
            type: "bar",
            data: {
              labels: [0,1,2,3,4,5,6,7,8,9],
              datasets: [{ data: counts }]
            },
            options: {
              plugins: { legend: { display: false }},
              scales: {
                x: { ticks: { color: "white" }},
                y: { ticks: { color: "white" }}
              }
            }
          });
        }
      }, [ticks]);

      const even = ticks.filter(d => d%2===0).length;
      const odd = ticks.length - even;
      const low = ticks.filter(d => d <= 4).length;
      const high = ticks.length - low;

      const recommend = () => {
        if (even > odd) return "HIGH PROB EVEN";
        if (odd > even) return "HIGH PROB ODD";
        return "NEUTRAL";
      };

      return (
        <div style={{padding: 10}}>
          <h2>Digit Probability â€” DARK</h2>
          <div className="box">
            <label>Market: </label>
            <select value={market} onChange={e=>setMarket(e.target.value)}>
              <option>R_10</option>
              <option>R_25</option>
              <option>R_50</option>
              <option>R_75</option>
              <option>R_100</option>
            </select>
          </div>

          <div className="box">
            <h3>Last Digits (30 Ticks)</h3>
            <p>{ticks.join(" ")}</p>
          </div>

          <div className="box">
            <canvas ref={chartRef}></canvas>
          </div>

          <div className="box">
            <h3>STATS</h3>
            <p>EVEN: {even} | ODD: {odd}</p>
            <p>UNDER(0-4): {low} | OVER(5-9): {high}</p>
            <h3>ENTRY: {recommend()}</h3>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
